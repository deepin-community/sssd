<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DocBook V4.4//EN"
"http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">
<reference>
<title>Справка по SSSD</title>
<refentry>
    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="include/upstream.xml" />

    <refmeta>
        <refentrytitle>sss_cache</refentrytitle>
        <manvolnum>8</manvolnum>
    </refmeta>

    <refnamediv id='name'>
        <refname>sss_cache</refname>
        <refpurpose>выполнить очистку кэша</refpurpose>
    </refnamediv>

    <refsynopsisdiv id='synopsis'>
        <cmdsynopsis>
<command>sss_cache</command> <arg choice='opt'>
<replaceable>options</replaceable> </arg></cmdsynopsis>
    </refsynopsisdiv>

    <refsect1 id='description'>
        <title>ОПИСАНИЕ</title>
        <para>
            <command>sss_cache</command> объявляет недействительными записи в кэше
SSSD. Объявленные недействительными записи принудительно повторно
загружаются с сервера, как только соответствующий внутренний сервер SSSD
появляется в сети. Параметры, объявляющие недействительность одного объекта,
принимают только один предоставленный аргумент.
        </para>
    </refsect1>

    <refsect1 id='options'>
        <title>ОПЦИИ</title>
        <variablelist remap='IP'>
            <varlistentry>
                <term>
                    <option>-E</option>,<option>--everything</option>
                </term>
                <listitem>
                    <para>
                        Объявить недействительными все кэшированные записи.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>
                    <option>-u</option>,<option>--user</option> <replaceable>login</replaceable>
                </term>
                <listitem>
                    <para>
                        Объявить недействительным определённого пользователя.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>
                    <option>-U</option>,<option>--users</option>
                </term>
                <listitem>
                    <para>
                        Объявить недействительными все записи пользователей. Этот параметр имеет
приоритет над параметром, который объявляет недействительным определённого
пользователя, если он также был задан.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>
                    <option>-g</option>,<option>--group</option>
<replaceable>group</replaceable>
                </term>
                <listitem>
                    <para>
                        Объявить недействительной определённую группу.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>
                    <option>-G</option>,<option>--groups</option>
                </term>
                <listitem>
                    <para>
                        Объявить недействительными все записи групп. Этот параметр имеет приоритет
над параметром, который объявляет недействительной определённую группу, если
он также был задан.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>
                    <option>-n</option>,<option>--netgroup</option>
<replaceable>netgroup</replaceable>
                </term>
                <listitem>
                    <para>
                        Объявить недействительной определённую сетевую группу.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>
                    <option>-N</option>,<option>--netgroups</option>
                </term>
                <listitem>
                    <para>
                        Объявить недействительными все записи сетевых групп. Этот параметр имеет
приоритет над параметром, который объявляет недействительной определённую
сетевую группу, если он также был задан.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>
                    <option>-s</option>,<option>--service</option>
<replaceable>service</replaceable>
                </term>
                <listitem>
                    <para>
                        Объявить недействительной определённую службу.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>
                    <option>-S</option>,<option>--services</option>
                </term>
                <listitem>
                    <para>
                        Объявить недействительными все записи служб. Этот параметр имеет приоритет
над параметром, который объявляет недействительной определённую службу, если
он также был задан.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry condition="with_autofs">
                <term>
                    <option>-a</option>,<option>--autofs-map</option>
<replaceable>autofs-map</replaceable>
                </term>
                <listitem>
                    <para>
                        Объявить недействительной определённую карту autofs.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry condition="with_autofs">
                <term>
                    <option>-A</option>,<option>--autofs-maps</option>
                </term>
                <listitem>
                    <para>
                        Объявить недействительными все карты autofs. Этот параметр имеет приоритет
над параметром, который объявляет недействительной определённую карту
autofs, если он также был задан.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry condition="with_ssh">
                <term>
                    <option>-h</option>,<option>--ssh-host</option>
<replaceable>hostname</replaceable>
                </term>
                <listitem>
                    <para>
                        Объявить недействительными открытые ключи SSH определённого узла.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry condition="with_ssh">
                <term>
                    <option>-H</option>,<option>--ssh-hosts</option>
                </term>
                <listitem>
                    <para>
                        Объявить недействительными открытые ключи SSH всех узлов. Этот параметр
имеет приоритет над параметром, который объявляет недействительными открытые
ключи SSH определённого узла, если он также был задан.
                    </para>
                </listitem>
            </varlistentry>
           <varlistentry condition="with_sudo">
                <term>
                    <option>-r</option>,<option>--sudo-rule</option>
<replaceable>rule</replaceable>
                </term>
                <listitem>
                    <para>
                        Объявить недействительным определённое правило sudo.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry condition="with_sudo">
                <term>
                    <option>-R</option>,<option>--sudo-rules</option>
                </term>
                <listitem>
                    <para>
                        Объявить недействительными все кэшированные правила sudo. Этот параметр
имеет приоритет над параметром, который объявляет недействительным
определённое правило sudo, если он также был задан.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>
                    <option>-d</option>,<option>--domain</option>
<replaceable>domain</replaceable>
                </term>
                <listitem>
                    <para>
                        Ограничить процесс объявления недействительности определённым доменом.
                    </para>
                </listitem>
            </varlistentry>
            <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="include/param_help.xml" />
        </variablelist>
    </refsect1>

    <refsect1 id='memcache'>
        <title>ВЛИЯНИЕ НА КЭШ В СВЕРХОПЕРАТИВНОЙ ПАМЯТИ</title>
        <para>
            <command>sss_cache</command> также объявляет недействительным кэш в
памяти. Так как кэш в памяти является файлом, который сопоставляется с
памятью каждого процесса, который вызывал SSSD для разрешения пользователей
или групп, этот файл не может быть усечён. В заголовке файла указывается
специальный флаг, который обозначает недействительность содержимого, и затем
ответчик NSS SSSD выполняет отмену связи этого файла, после чего создаётся
новый файл кэша. Теперь, когда процесс выполняет новый поиск пользователя
или группы, он видит флаг, закрывает старый файл кэша в памяти и
сопоставляет со своей памятью новый файл. Когда все процессы, которые
открывали старый файл кэша в памяти, закроют его при поиске пользователя или
группы, ядро сможет освободить занятое пространство на диске и старый файл
кэша в памяти будет полностью удалён.
        </para>
        <para>
            Особый случай представляют длительно выполняемые процессы, которые
осуществляют поиск пользователей или групп только при запуске (например,
чтобы определить имя пользователя, от имени которого запущен процесс). Для
такого поиска файл кэша в памяти сопоставляется с памятью процесса. Но, так
как дальнейшего поиска не будет, этот процесс никогда не определит, был ли
объявлен недействительным файл кэша в памяти, и поэтому он будет оставлен в
памяти и будет занимать пространство на диске до тех пор, пока процесс не
остановится. Следовательно, вызов <command>sss_cache</command> может
увеличить использование места на диске, потому что старые файлы кэша в
памяти не могут быть удалены с диска, так как они всё ещё сопоставляются
длительно выполняемыми процессами.
        </para>
        <para>
            Чтобы обойти эту проблему для длительно выполняемых процессов, которые
выполняют поиск пользователей и групп только при запуске или очень редко,
можно запускать их с переменной среды SSS_NSS_USE_MEMCACHE, установленной в
значение «NO»: в этом случае они вообще не будут использовать кэш в памяти и
не будут сопоставлять файл кэша в памяти с памятью. В целом, лучшим решением
проблемы будет настроить параметры тайм-аута кэша таким образом, чтобы они
соответствовали локальным ожиданиям и не требовался вызов
<command>sss_cache</command>.
        </para>
    </refsect1>

    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="include/seealso.xml" />

</refentry>
</reference>
